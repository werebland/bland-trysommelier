{"version":3,"file":"static/webpack/static/development/pages/onboard.js.3e99086a20c402c3c432.hot-update.js","sources":["webpack:///./pages/onboard.js"],"sourcesContent":["import React, { Component } from 'react';\nimport firebase from 'firebase/app'\nimport 'firebase/auth'\nimport base from '../config'\nimport styled from 'styled-components';\nimport posed, {PoseGroup} from 'react-pose'\nimport axios from 'axios';\nimport Head from 'next/head'\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Grid from '@material-ui/core/Grid';\nimport _ from 'lodash'\n\nimport AccessForm from '../components/AccessForm'\nimport MenuUploader from '../components/MenuUploader'\n\nconst StyledButton = styled(Button)`\n  text-transform: none !important;\n  border-radius: 8px !important;\n  background: ${props => props.variant === \"contained\" ? '#54a0ff' : 'transparent'} !important;\n  box-shadow: ${props => props.variant === \"contained\" ? '0 2px 16px -2px rgba(31,31,31,0.32)' : 'none'} !important;\n  color: ${props => props.variant === \"contained\" ? '#fff' : '#1f1f1f'} !important;\n`;\n\nconst StyledTextField = styled(TextField)`\n  width: 100% !important;\n  border-radius: 8px !important;\n  font-family: 'Source Sans Pro', sans-serif !important;\n  box-sizing; border-box !important;\n\n  & fieldset {\n    border: 2px solid #1f1f1f !important;\n    border-radius: 8px !important;\n  }\n\n  & input {\n    font-family: 'Source Sans Pro', sans-serif !important;\n  }\n`;\n\nconst PageWrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  min-height: 100vh;\n  display: flex;\n  flex-flow: row nowrap;\n`;\n\nconst OnboardContent= styled.div`\n  height: 100%;\n  min-height: 100vh;\n  box-sizing: border-box;\n  padding: 16px;\n  background: #fff;\n  display: flex;\n  flex: .4;\n  flex-flow: column nowrap;\n  align-items: center;\n  justify-content: center;\n  overflow: hidden;\n  position: relative;\n`;\n\nconst PageTitle = styled.h1`\n  font-size: 2rem;\n  font-weight: 700;\n  font-family: 'Montserrat', sans-serif;\n  color: #1f1f1f;\n  position: relative;\n  margin: 0 auto 16px;\n  display: inline-flex;\n  z-index: 1;\n\n  &:after {\n    content: \"\";\n    width: 100%;\n    height: 8px;\n    background: #f94343;\n    display: block;\n    position: absolute;\n    bottom: 0px;\n    left: 4px;\n    z-index: -1;\n  }\n`;\n\nconst OnboardBackground = styled.div`\n  width: 77%;\n  height: 100%;\n  min-height: 100vh;\n  background: aliceblue;\n  background-image: url('https://images.unsplash.com/photo-1550259114-ad7188f0a967?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1100&q=80');\n  background-position: center;\n  background-size: cover;\n  display: flex;\n  flex: .6;\n\n`;\n\nconst OnboardStepper = styled.div`\n  width: 100%;\n`;\n\nconst PosedOnboardStepperContent = posed.div({\n  enter: {\n    x: 0,\n    opacity: 1,\n  },\n  exit: {\n    x: ({ activeStep, step }) => activeStep <= step ? 300 : -300,\n    opacity: 0,\n  }\n})\n\nconst OnboardStepperContent = styled(props => <PosedOnboardStepperContent {...props}/>)`\n\n`;\n\nconst styles = theme => ({\n  root: {\n    width: '90%',\n  },\n  backButton: {\n    marginRight: theme.spacing.unit,\n  },\n  instructions: {\n    marginTop: theme.spacing.unit,\n    marginBottom: theme.spacing.unit,\n  },\n});\n\nconst StepperButtons = styled.div`\n  width: 100%;\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: space-between;\n  flex-direction: ${props => props.activeStep === 0 ? 'row-reverse' : 'row'};\n`;\n\nclass Onboard extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      user: {},\n      restaurant: {},\n      menus: [],\n      activeStep: 0,\n      email: \"\",\n      name: \"\",\n    }\n  }\n\n  componentDidMount() {\n    console.log(window.location.search);\n    var vars = {};\n    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {\n        vars[key] = value;\n    });\n    console.log(vars);\n    const { email } = vars\n    console.log(email);\n    if (email) {\n      base.get('users', {\n        context: this,\n        query: (ref) => ref.where('email', '==', email),\n      }).then(data => {\n        this.setState({\n          user: data[0]\n        })\n      }).catch(err => {\n        //handle error\n      })\n    }\n\n  }\n\n  handleAccess(e) {\n    e.preventDefault();\n    const { email, name } = this.state\n    const names = _.split(name, ' ', 2)\n    const firstName = names[0]\n    const lastName = names[1]\n    const data = {\n      email,\n      firstName,\n      lastName\n    }\n    const formattedData = JSON.stringify(data)\n    console.log(formattedData);\n    axios({\n      method: 'post',\n      url: 'https://wt-2c136a182f9df0f639eceee9aa700a3d-0.sandbox.auth0-extend.com/somm-mailchimp',\n      data: formattedData,\n      headers: {\n        'Access-Control-Allow-Credentials': true,\n        'Access-Control-Allow-Origin': 'http://localhost:3000',\n        'Access-Control-Expose-Headers': 'x-auth0-proxy-stats, x-auth0-stats, x-wt-response-source, location',\n        'Content-Type': 'application/json'\n      }\n    }).then((response) => {\n      console.log(response);\n      this.setState({\n        accessStatus: 'success'\n      })\n    })\n    .catch((error) => {\n      console.log(error.response.data);\n      this.setState({\n        accessStatus: error.response.data.details.title\n      })\n    });\n  }\n\n  handleNext = () => {\n    this.setState(state => ({\n      activeStep: state.activeStep + 1,\n    }));\n  };\n\n  handleBack = () => {\n    this.setState(state => ({\n      activeStep: state.activeStep - 1,\n    }));\n  };\n\n  handleReset = () => {\n    this.setState({\n      activeStep: 0,\n    });\n  };\n\n  handleDrop = (accepted, rejected) => {\n    let { menus } = this.state\n    _.forEach(accepted, function(file) {\n      const menu = {\n        name: file.name,\n        file\n      }\n      menus.push(menu)\n    })\n    this.setState({\n      menus\n    })\n  };\n\n  handleRemove = (i) => {\n    const { menus } = this.state\n    console.log('removed' + i);\n    menus.splice(i, 1)\n    this.setState({\n      menus\n    });\n  };\n\n  handleMenuName = (value, i) => {\n    let { menus } = this.state\n    menus[i].name = value\n    this.setState({\n      menus\n    })\n  }\n\n  render() {\n    const { classes } = this.props;\n    const steps = ['Tell us about your restaurant', 'Upload your menus', 'Customize your widget']\n    const { activeStep, restaurant, menus } = this.state;\n    const { email, firstName, lastName, name } = restaurant\n\n    return (\n      <PageWrapper>\n        <Head>\n          <title>\n            Onboard | Somm\n          </title>\n        </Head>\n        {Object.keys(user).length > 0\n          ?\n          <OnboardContent>\n            <PageTitle>\n              Hop onboard\n            </PageTitle>\n            <OnboardStepper>\n              <Stepper activeStep={activeStep} alternativeLabel>\n                {steps.map(label => (\n                  <Step key={label}>\n                    <StepLabel>{label}</StepLabel>\n                  </Step>\n                ))}\n              </Stepper>\n              <PoseGroup activeStep={activeStep} preEnterPose=\"preEnter\">\n                {activeStep === 0 &&\n                  <OnboardStepperContent key=\"0\" step={0}>\n                    <Grid container spacing={16}>\n                      <Grid item sm={12} md={12} lg={6} xl={6}>\n                        <StyledTextField variant=\"outlined\" label=\"First name\" value={firstName} onChange={(e) => this.setState({ email: e.target.value })}/>\n                      </Grid>\n                      <Grid item sm={12} md={12} lg={6} xl={6}>\n                        <StyledTextField variant=\"outlined\" label=\"Last name\" value={lastName} onChange={(e) => this.setState({ email: e.target.value })}/>\n                      </Grid>\n                      <Grid item sm={12} md={12} lg={12} xl={12}>\n                        <StyledTextField variant=\"outlined\" label=\"Email\" value={email} onChange={(e) => this.setState({ [restaurant.email]: e.target.value })}/>\n                      </Grid>\n                      <Grid item sm={12} md={12} lg={12} xl={12}>\n                        <StyledTextField variant=\"outlined\" label=\"Restaurant name\" value={name} onChange={(e) => this.setState({ [restaurant.email]: e.target.value })}/>\n                      </Grid>\n                    </Grid>\n                  </OnboardStepperContent>\n                }\n                {activeStep === 1 &&\n                  <OnboardStepperContent key=\"1\" step={1}>\n                    <MenuUploader\n                      files={this.state.menus}\n                      handleDrop={(accepted, rejected) => this.handleDrop(accepted, rejected)}\n                      handleRemove={(i) => this.handleRemove(i)}\n                      handleMenuName={(value, i) => this.handleMenuName(value, i)}/>\n                  </OnboardStepperContent>\n                }\n                {activeStep === 2 &&\n                  <OnboardStepperContent key=\"2\" step={2}>\n                    Widget customizer\n                  </OnboardStepperContent>\n                }\n              </PoseGroup>\n              <StepperButtons activeStep={activeStep}>\n                {this.state.activeStep > 0 &&\n                  <StyledButton onClick={this.handleBack}>\n                    Back\n                  </StyledButton>\n                }\n                <StyledButton variant=\"contained\" onClick={this.handleNext}>\n                  {activeStep === 2\n                    ?\n                    \"Finish\"\n                    :\n                    \"Next\"\n                  }\n                </StyledButton>\n              </StepperButtons>\n            </OnboardStepper>\n          </OnboardContent>\n          :\n          <OnboardContent>\n            <PageTitle>\n              Whoops!\n            </PageTitle>\n            It doesn't look like you're part of our early access program yet.\n            <AccessForm\n              handleAccess={(e) => this.handleAccess(e)}\n              email={this.state.email}\n              handleEmail={(email) => this.setState({ email })}\n              name={this.state.name}\n              handleName={(name) => this.setState({ name })}\n              accessStatus={this.state.accessStatus}\n              handleClear={() => this.setState({ accessStatus: \"\", name: \"\", email: \"\" })}/>\n          </OnboardContent>\n        }\n\n        <OnboardBackground />\n      </PageWrapper>\n    );\n  }\n\n}\n\nexport default Onboard;\n"],"mappings":"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","sourceRoot":""}